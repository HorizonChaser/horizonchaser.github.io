

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/avatar_small_round.png">
  <link rel="icon" type="image/png" href="/img/avatar_small_round.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="Horizon">
  <meta name="keywords" content="">
  <title>计算机安全导论 复习笔记 - Horizon Blog</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      
        
        
        
      
      <link  rel="stylesheet" href="https://cdn.staticfile.org/prism/1.21.0/themes/prism-coy.min.css" />
      
        <link  rel="stylesheet" href="https://cdn.staticfile.org/prism/1.21.0/plugins/line-numbers/prism-line-numbers.min.css" />
      
    
  

  
    <link  rel="stylesheet" href="https://cdn.staticfile.org/gitalk/1.6.2/gitalk.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_pf9vaxs7x7b.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->

  
<link rel="stylesheet" href="/css/icon_cloud/iconfont.css">



  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 6.1.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/rss2.xml" title="Horizon Blog" type="application/rss+xml">
</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Horizon Blog</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/bangumis/index.html">
                <i class="iconfont icon-bilibili-fill"></i>
                Bangumi
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-friends"></i>
                友链
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner intro-2" id="background" parallax=true
         style="background: url('/img/index_banner.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container page-header text-center fade-in-up">
            <span class="h2" id="subtitle">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-03-10 16:57" pubdate>
         2022年3月10日 周四 16:57:36
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      9k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      大概 
      110
       分钟
    </span>
  

  
  
    
      <!-- 不蒜子统计文章PV -->
      <span id="busuanzi_container_page_pv" style="display: none">
        <i class="iconfont icon-eye" aria-hidden="true"></i>
        <span id="busuanzi_value_page_pv"></span> 次
      </span>
    
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto" id="post">
            <!-- SEO header -->
            <h1 style="display: none">计算机安全导论 复习笔记</h1>
            
              <p class="note note-info">
                
                  Last Update @ 2022年9月4日 周日 16:5:22
                
              </p>
            
            <div class="markdown-body" id="post-body">
              <ul>
<li><a href="#%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%AE%89%E5%85%A8%E5%AF%BC%E8%AE%BA-%E5%A4%8D%E4%B9%A0%E4%B8%8E%E6%80%BB%E7%BB%93">计算机安全导论 复习与总结</a>
<ul>
<li><a href="#chapter-1-%E7%AE%80%E4%BB%8B">Chapter 1 简介</a>
<ul>
<li><a href="#11-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5">1.1 基本概念</a>
<ul>
<li><a href="#imp-cia-%E6%9C%BA%E5%AF%86%E6%80%A7-%E5%AE%8C%E6%95%B4%E6%80%A7%E5%92%8C%E5%8F%AF%E7%94%A8%E6%80%A7-p2">[IMP] C.I.A.: 机密性, 完整性和可用性 [P2]</a></li>
<li><a href="#imp-aaa-%E4%BF%9D%E8%AF%81-%E7%9C%9F%E5%AE%9E%E6%80%A7-%E5%8C%BF%E5%90%8D-p6">[IMP] A.A.A.: 保证, 真实性, 匿名 [P6]</a></li>
<li><a href="#%E5%A8%81%E8%83%81%E4%B8%8E%E6%94%BB%E5%87%BB">威胁与攻击</a></li>
<li><a href="#%E5%8D%81%E5%A4%A7%E5%AE%89%E5%85%A8%E5%8E%9F%E5%88%99">十大安全原则</a></li>
</ul>
</li>
<li><a href="#imp-12-%E5%9B%9B%E7%A7%8D%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%A8%A1%E5%9E%8B%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9-p11">[IMP] 1.2 四种访问控制模型的优缺点 [P11]</a></li>
<li><a href="#imp-13-%E5%8A%A0%E5%AF%86%E7%9A%84%E6%A6%82%E5%BF%B5-p16">[IMP] 1.3 加密的概念 [P16]</a>
<ul>
<li><a href="#%E5%8A%A0%E5%AF%86">加密</a></li>
<li><a href="#%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D">数字签名</a></li>
<li><a href="#%E5%8A%A0%E5%AF%86%E6%95%A3%E5%88%97%E5%87%BD%E6%95%B0">加密散列函数</a></li>
<li><a href="#%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6">数字证书</a></li>
</ul>
</li>
<li><a href="#14-%E5%8F%AF%E7%94%A8%E6%80%A7-%E5%AF%86%E7%A0%81-%E5%AD%97%E5%85%B8%E6%94%BB%E5%87%BB%E5%8E%9F%E7%90%86-%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6">1.4 可用性 密码 字典攻击原理 社会工程学</a>
<ul>
<li><a href="#%E5%8F%AF%E7%94%A8%E6%80%A7">可用性</a></li>
<li><a href="#imp-%E5%AF%86%E7%A0%81%E5%8F%8A%E5%AD%97%E5%85%B8%E6%94%BB%E5%87%BB%E5%8E%9F%E7%90%86-p27">[IMP] 密码及字典攻击原理 [P27]</a></li>
<li><a href="#%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B">社会工程</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#chapter-2-%E7%89%A9%E7%90%86%E5%AE%89%E5%85%A8">Chapter 2 物理安全</a>
<ul>
<li><a href="#%E5%BC%B9%E5%AD%90%E9%94%81">弹子锁</a></li>
<li><a href="#%E7%94%B5%E5%AD%90%E5%AF%86%E7%A0%81%E9%94%81">电子密码锁</a></li>
<li><a href="#%E5%B8%B8%E7%94%A8%E7%9A%84%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81%E6%8A%80%E6%9C%AF">常用的身份验证技术</a></li>
<li><a href="#imp-sim-%E5%8D%A1%E5%AE%89%E5%85%A8%E5%8F%8A%E6%8C%91%E6%88%98%E5%93%8D%E5%BA%94%E5%8D%8F%E8%AE%AE">[IMP] SIM 卡安全及挑战响应协议</a></li>
<li><a href="#%E9%92%88%E5%AF%B9%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%9A%84%E7%9B%B4%E6%8E%A5%E6%94%BB%E5%87%BB">针对计算机的直接攻击</a></li>
<li><a href="#%E9%92%88%E5%AF%B9-atm-%E7%9A%84%E6%94%BB%E5%87%BB">针对 ATM 的攻击</a></li>
</ul>
</li>
<li><a href="#chapter-3-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%AE%89%E5%85%A8">Chapter 3 操作系统的安全</a>
<ul>
<li><a href="#%E8%BF%9B%E7%A8%8B%E7%9A%84%E5%AE%89%E5%85%A8">进程的安全</a></li>
<li><a href="#%E5%86%85%E5%AD%98%E5%92%8C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%AE%89%E5%85%A8">内存和文件系统的安全</a></li>
<li><a href="#imp-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%AE%89%E5%85%A8-p97">[IMP] 应用程序安全 [P97]</a></li>
</ul>
</li>
<li><a href="#chapter-4-%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6">Chapter 4 恶意软件</a>
<ul>
<li><a href="#%E5%86%85%E9%83%A8%E6%94%BB%E5%87%BB%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%96%B9%E5%BC%8F">内部攻击的基本方式</a></li>
<li><a href="#imp-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%97%85%E6%AF%92-%E6%9C%A8%E9%A9%AC%E5%92%8C%E8%A0%95%E8%99%AB-p120">[IMP] 计算机病毒, 木马和蠕虫 [P120]</a></li>
<li><a href="#rootkits">Rootkits</a></li>
<li><a href="#%E9%9B%B6%E6%97%A5%E6%94%BB%E5%87%BB">零日攻击</a></li>
<li><a href="#%E5%83%B5%E5%B0%B8%E7%BD%91%E7%BB%9C">僵尸网络</a></li>
<li><a href="#%E5%85%A5%E4%BE%B5%E9%9A%90%E7%A7%81%E8%BD%AF%E4%BB%B6">入侵隐私软件</a></li>
</ul>
</li>
<li><a href="#imp-chapter-5-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8-i">[IMP] Chapter 5 网络安全 I</a>
<ul>
<li><a href="#%E4%BA%92%E8%81%94%E7%BD%91%E7%9A%84%E5%88%86%E5%B1%82">互联网的分层</a></li>
<li><a href="#%E4%BB%A5%E5%A4%AA%E7%BD%91%E7%9A%84%E6%A6%82%E5%BF%B5">以太网的概念</a></li>
<li><a href="#imp-arp-%E6%AC%BA%E9%AA%97-p155">[IMP] ARP 欺骗 [P155]</a></li>
<li><a href="#imp-ip-%E5%8D%8F%E8%AE%AE%E4%B8%8E-icmp-%E5%8D%8F%E8%AE%AE-p157">[IMP] IP 协议与 ICMP 协议 [P157]</a></li>
<li><a href="#imp-ip-%E5%9C%B0%E5%9D%80%E6%AC%BA%E9%AA%97-p161">[IMP] IP 地址欺骗 [P161]</a></li>
<li><a href="#%E6%95%B0%E6%8D%AE%E5%8C%85%E5%97%85%E6%8E%A2">数据包嗅探</a></li>
<li><a href="#%E4%BC%A0%E8%BE%93%E5%B1%82%E5%8D%8F%E8%AE%AE">传输层协议</a></li>
<li><a href="#imp-tcp-%E4%BC%9A%E8%AF%9D%E5%8A%AB%E6%8C%81-p168">[IMP] TCP 会话劫持 [P168]</a></li>
<li><a href="#imp-%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB-p170">[IMP] 拒绝服务攻击 [P170]</a></li>
<li><a href="#imp-ip-%E5%9C%B0%E5%9D%80%E5%9B%9E%E6%BA%AF-p175">[IMP] IP 地址回溯 [P175]</a></li>
</ul>
</li>
<li><a href="#imp-chapter-6-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8-ii-p180">[IMP] Chapter 6 网络安全 II [P180]</a>
<ul>
<li><a href="#imp-dns-%E5%8E%9F%E7%90%86-p183">[IMP] DNS 原理 [P183]</a></li>
<li><a href="#imp-dns-%E6%94%BB%E5%87%BB-p185">[IMP] DNS 攻击 [P185]</a></li>
<li><a href="#%E9%98%B2%E7%81%AB%E5%A2%99%E6%8A%80%E6%9C%AF">防火墙技术</a></li>
<li><a href="#imp-%E9%9A%A7%E9%81%93-p195">[IMP] 隧道 [P195]</a>
<ul>
<li><a href="#imp-%E5%AE%89%E5%85%A8%E7%9A%84-shell-p196">[IMP] 安全的 Shell [P196]</a></li>
<li><a href="#imp-ipsec-p197">[IMP] IPSec [P197]</a></li>
</ul>
</li>
<li><a href="#%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E7%BD%91%E7%BB%9C">虚拟专用网络</a></li>
<li><a href="#%E5%85%A5%E4%BE%B5%E6%A3%80%E6%B5%8B">入侵检测</a></li>
</ul>
</li>
<li><a href="#chapter-7-web-%E5%AE%89%E5%85%A8">Chapter 7 Web 安全</a>
<ul>
<li><a href="#%E7%BD%91%E7%BB%9C%E9%92%93%E9%B1%BC">网络钓鱼</a></li>
<li><a href="#imp-xss-%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC-p239">[IMP] XSS (跨站脚本) [P239]</a></li>
<li><a href="#%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0">跨站请求伪造</a></li>
<li><a href="#imp-sql-%E6%B3%A8%E5%85%A5-p251">[IMP] SQL 注入 [P251]</a></li>
</ul>
</li>
<li><a href="#chapter-8-%E5%8A%A0%E5%AF%86-%E5%AF%86%E7%A0%81%E5%AD%A6%E6%A6%82%E8%BF%B0">Chapter 8 加密 (密码学概述)</a>
<ul>
<li><a href="#%E5%AF%B9%E5%AF%86%E7%A0%81%E7%B3%BB%E7%BB%9F%E6%94%BB%E5%87%BB%E7%9A%84%E7%B1%BB%E5%9E%8B">对密码系统攻击的类型</a></li>
<li><a href="#%E6%9B%BF%E6%8D%A2%E5%AF%86%E7%A0%81%E5%92%8C%E9%A2%91%E7%8E%87%E5%88%86%E6%9E%90">替换密码和频率分析</a></li>
<li><a href="#%E4%B8%80%E6%AC%A1%E4%B8%80%E5%AF%86-otp">一次一密 (OTP)</a></li>
<li><a href="#%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81">分组密码</a></li>
<li><a href="#aes-%E7%AE%97%E6%B3%95">AES 算法</a></li>
<li><a href="#%E5%88%86%E7%BB%84%E5%AF%86%E7%A0%81%E7%9A%84%E6%93%8D%E4%BD%9C%E6%A8%A1%E5%BC%8F">分组密码的操作模式</a></li>
<li><a href="#%E6%B5%81%E5%AF%86%E7%A0%81">流密码</a></li>
<li><a href="#%E6%95%B0%E8%AE%BA%E5%9F%BA%E7%A1%80">数论基础</a>
<ul>
<li><a href="#%E8%BE%97%E8%BD%AC%E7%9B%B8%E9%99%A4%E6%B3%95-%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95">辗转相除法 (欧几里得算法)</a></li>
<li><a href="#%E8%B4%B9%E9%A9%AC%E5%AE%9A%E7%90%86%E5%92%8C%E6%AC%A7%E6%8B%89%E5%AE%9A%E7%90%86">费马定理和欧拉定理</a></li>
</ul>
</li>
<li><a href="#rsa-%E7%AE%97%E6%B3%95">RSA 算法</a></li>
<li><a href="#%E6%95%A3%E5%88%97%E5%87%BD%E6%95%B0-%E5%93%88%E5%B8%8C%E5%87%BD%E6%95%B0">散列函数 (哈希函数)</a></li>
<li><a href="#%E7%94%9F%E6%97%A5%E6%94%BB%E5%87%BB">生日攻击</a></li>
<li><a href="#%E6%B6%88%E6%81%AF%E8%AE%A4%E8%AF%81%E7%A0%81">消息认证码</a></li>
</ul>
</li>
<li><a href="#chapter-9-%E5%AE%89%E5%85%A8%E6%A8%A1%E5%9E%8B%E4%B8%8E%E5%AE%9E%E8%B7%B5">Chapter 9 安全模型与实践</a>
<ul>
<li><a href="#kerberos-%E6%9E%B6%E6%9E%84">Kerberos 架构</a></li>
<li><a href="#kerberos-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81">Kerberos 身份验证</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="计算机安全导论-复习与总结"><a class="markdownIt-Anchor" href="#计算机安全导论-复习与总结"></a> 计算机安全导论 复习与总结</h1>
<h2 id="chapter-1-简介"><a class="markdownIt-Anchor" href="#chapter-1-简介"></a> Chapter 1 简介</h2>
<h3 id="11-基本概念"><a class="markdownIt-Anchor" href="#11-基本概念"></a> 1.1 基本概念</h3>
<h4 id="imp-cia-机密性-完整性和可用性-p2"><a class="markdownIt-Anchor" href="#imp-cia-机密性-完整性和可用性-p2"></a> [IMP] C.I.A.: 机密性, 完整性和可用性 [P2]</h4>
<ul>
<li>机密性 (congfidentiality): 避免未授权信息的泄露, 涉及数据的保护 (加密, 身份验证, 授权, 物理安全等)</li>
<li>完整性 (integrity): 不能以未授权的方式改变信息的属性</li>
<li>可用性 (avaliability): 对任何授权用户都可以及时地访问和修改信息</li>
</ul>
<h4 id="imp-aaa-保证-真实性-匿名-p6"><a class="markdownIt-Anchor" href="#imp-aaa-保证-真实性-匿名-p6"></a> [IMP] A.A.A.: 保证, 真实性, 匿名 [P6]</h4>
<ul>
<li>保证 (assurance): 在计算机系统中如何管理和提供信任, 例如策略 权限 保护等
<ul>
<li>信任管理 (trust management)</li>
<li>软件工程</li>
</ul>
</li>
<li>真实性 (authenticity): 能够确定由人或系统发布的声明, 策略, 权限等是名副其实的能力
<ul>
<li>通过数字签名实现</li>
</ul>
</li>
<li>匿名 (anonymity): 不保存任何足够辨识的个人信息</li>
</ul>
<h4 id="威胁与攻击"><a class="markdownIt-Anchor" href="#威胁与攻击"></a> 威胁与攻击</h4>
<p>类型: 窃听, 修改, 拒绝服务 (服务或信息访问的中断或退化), 冒充 (例如钓鱼), 抵赖 (对承诺或数据接收的否认, 是一种对于保证的攻击)</p>
<h4 id="十大安全原则"><a class="markdownIt-Anchor" href="#十大安全原则"></a> 十大安全原则</h4>
<ul>
<li>机制的经济性</li>
<li>故障安全默认值</li>
<li>完全仲裁: 检查每一次访问是否满足保护方案</li>
<li>开放式设计: 安全只依赖于密钥的保密, 可由多方检查系统</li>
<li>特权分离</li>
<li>最小特权</li>
<li>最少公共机制: 多用户时共享机制最小化, 也就是尽可能独立</li>
<li>心里可接受: 接口和用户的预期一致</li>
<li>工作因素: 绕过安全机制的代价应与攻击者的资源相比较
<ul>
<li>大概是类似 workload factor 的意思, 就是说复杂度要合适, 不能过度保护</li>
</ul>
</li>
<li>记录危害</li>
</ul>
<h3 id="imp-12-四种访问控制模型的优缺点-p11"><a class="markdownIt-Anchor" href="#imp-12-四种访问控制模型的优缺点-p11"></a> [IMP] 1.2 四种访问控制模型的优缺点 [P11]</h3>
<p>最小权限原则: 限制用户只能访问或修改与他们相关的信息</p>
<ul>
<li>访问控制矩阵 (Access Control Matrix)
<ul>
<li>每一行是主体 (用户, 组, 或者可以执行操作的其他实体)</li>
<li>每一列是客体 (文件, 目录等需要定义访问权限的其他任何实体)</li>
<li>单元格中为权限, 例如读 写 执行等</li>
<li><strong>优点</strong>
<ul>
<li>快速直接确定任何主体-客体的访问控制权限</li>
<li>简单直观</li>
</ul>
</li>
<li><strong>缺点</strong>
<ul>
<li>矩阵可能很大</li>
</ul>
</li>
</ul>
</li>
<li>访问控制列表 (<strong>ACL</strong>, Access Control List)
<ul>
<li>以客体为中心, 每个客体拥有一个列表, 记录了所有对该客体拥有访问权限的主体</li>
<li>类似将矩阵按照列拆分</li>
<li><strong>优点</strong>
<ul>
<li>大小较小 (尤其是和访问控制矩阵相比)</li>
<li>对安全的系统, 可以将 ACL 保存为客体的元数据</li>
</ul>
</li>
<li><strong>缺点</strong>
<ul>
<li>除了遍历客体, 否则无法从主体查询该主体的所有访问权限</li>
</ul>
</li>
</ul>
</li>
<li>权能 (capablity)
<ul>
<li>以主体为中心, 记录该主体拥有访问权限的客体</li>
<li>类似将矩阵按照行拆分</li>
<li><strong>优点</strong>
<ul>
<li>大小较小</li>
</ul>
</li>
<li><strong>缺点</strong>
<ul>
<li>没有与客体直接关联</li>
</ul>
</li>
</ul>
</li>
<li>基于角色的访问控制 (RBAC, Role-Based Access Control)
<ul>
<li>管理员定义角色, 然后指定角色的访问控制权限 (而不是直接指定主体的)</li>
<li>然后将主体分配到不同的角色 (可以是多个角色)</li>
<li>角色间可以有层级结构</li>
<li><strong>优点</strong>
<ul>
<li>记录的规则总数少, 效率高</li>
</ul>
</li>
<li><strong>缺点</strong>
<ul>
<li>现有操作系统尚未实现</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="imp-13-加密的概念-p16"><a class="markdownIt-Anchor" href="#imp-13-加密的概念-p16"></a> [IMP] 1.3 加密的概念 [P16]</h3>
<h4 id="加密"><a class="markdownIt-Anchor" href="#加密"></a> 加密</h4>
<p>允许双方在不安全的通道上建立保密的通信, 即进行明文和密文间的可逆变换</p>
<p>加密和解密使用相同密钥的方案称为对称密码系统或共享密钥密码系统, 例如 AES, DES 等 (密钥较短, 速度较快)</p>
<p>公钥密码系统: 使用公钥加密, 使用私钥解密; 公钥公开, 私钥解密, 例如 RSA (密钥较长, 速度较慢)</p>
<h4 id="数字签名"><a class="markdownIt-Anchor" href="#数字签名"></a> 数字签名</h4>
<p>利用公钥密码系统, 可以将消息 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span> 和私钥 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">S_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 作为解密算法的输入, 然后将解密算法的输出和公钥 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">P_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 作为加密算法的输入得到消息 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span>. 任何拥有私钥的人都可以做到这点.</p>
<p>由此, 若作者 A 欲证明其为消息 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span></span> 的作者, 可以先使用私钥 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">S_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 对消息解密, 得到的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span></span></span></span> 即为 M 的数字签名. 接收者可以使用 A 的公钥 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">S_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 再次加密 S, 如果正确则应当得到 M. 由于只有 A 拥有私钥 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">P_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, 因此接收者可以确定 M 的作者一定为 A.</p>
<p>这种方法的唯一缺点: 签名和明文至少等长, 无法实用</p>
<h4 id="加密散列函数"><a class="markdownIt-Anchor" href="#加密散列函数"></a> 加密散列函数</h4>
<blockquote>
<p>不知道为啥要加个加密, 注意散列函数<strong>不是加密, 因为散列不可逆</strong></p>
</blockquote>
<p>散列函数: 单向的, 不可逆, 即不能由输出倒推输入</p>
<p>对某信息产生的散列值也称作摘要 (digest), 摘要一般都比原消息要短. 通过对消息的摘要进行数字签名更加高效, 而且可以防止中间人攻击 (MITM Attack) 和篡改 (很难找到两个摘要一样的信息)</p>
<p>消息认证码 (Message Authication Code, MAC): 可以对通过不安全信道交换的信息提供完整性保护</p>
<h4 id="数字证书"><a class="markdownIt-Anchor" href="#数字证书"></a> 数字证书</h4>
<p>数字证书: 由证书颁发机构 (Certificate Authority, CA) 颁发, 能将公钥和公钥拥有者的身份信息绑定在一起.</p>
<p>为了验证证书本身的可信性, 证书本身带有对自己的数字签名, 我们也需要保存 CA 的公钥用来验证.</p>
<h3 id="14-可用性-密码-字典攻击原理-社会工程学"><a class="markdownIt-Anchor" href="#14-可用性-密码-字典攻击原理-社会工程学"></a> 1.4 可用性 密码 字典攻击原理 社会工程学</h3>
<h4 id="可用性"><a class="markdownIt-Anchor" href="#可用性"></a> 可用性</h4>
<p>安全解决方案应该是高效的, 因为用户不喜欢慢的系统</p>
<h4 id="imp-密码及字典攻击原理-p27"><a class="markdownIt-Anchor" href="#imp-密码及字典攻击原理-p27"></a> [IMP] 密码及字典攻击原理 [P27]</h4>
<p>字典攻击: 大多数容易记住的密码属于一个很小的集合, 因此可以通过收集常用的密码作为尝试的集合进行枚举</p>
<h4 id="社会工程"><a class="markdownIt-Anchor" href="#社会工程"></a> 社会工程</h4>
<p>利用人们内心的弱点攻破安全解决方案.</p>
<ul>
<li>假托: 伪装成另外一个人</li>
<li>诱饵: 例如散布免费但装有攻击程序的 U 盘等</li>
<li>相等补偿 (对等交换): 利用不想白占便宜的心理</li>
</ul>
<h2 id="chapter-2-物理安全"><a class="markdownIt-Anchor" href="#chapter-2-物理安全"></a> Chapter 2 物理安全</h2>
<h3 id="弹子锁"><a class="markdownIt-Anchor" href="#弹子锁"></a> 弹子锁</h3>
<p>上下弹子在同一直线上, 但并没连接在一起. 通过钥匙让所有上下弹子中间的缝隙对齐即可开锁. 详细的看书.</p>
<p><img src="https://gitee.com/HorizonChaser/pic-bed/raw/master/img/20211230231444.png" srcset="/img/loading.gif" alt="弹子锁"></p>
<h3 id="电子密码锁"><a class="markdownIt-Anchor" href="#电子密码锁"></a> 电子密码锁</h3>
<p>通过使用电磁铁或电机来操作锁, 开锁信号可由电子密码, 磁条卡, 智能卡, RFID标签, 生物识别等给出.</p>
<h3 id="常用的身份验证技术"><a class="markdownIt-Anchor" href="#常用的身份验证技术"></a> 常用的身份验证技术</h3>
<p>条形码: 一维的和二维的 (条的和方的)</p>
<p>磁条卡: 三条磁道 (分别是个人信息, 卡号以及未使用), 可以被直接复制</p>
<p>智能卡: 可以内带芯片, 便宜的可能只有存储器, 可能通过差分功耗分析泄露密钥 (不同操作消耗的功率不同)</p>
<p>SIM 卡: Subscriber Identity Module Card, 客户识别模块卡, 用于手机的智能卡, 标识了用户的身份和联系方式</p>
<p>RFID: 无线射频识别, 自带一个线圈作为天线, 可用于商品标签或护照等, 可使用跳码进行认证<br>
生物特征识别: 特征需要满足普遍性, 独特性, 永久性和可收集性, 通过将特征量化为特征向量并和预先存储的参考向量比较完成识别</p>
<h3 id="imp-sim-卡安全及挑战响应协议"><a class="markdownIt-Anchor" href="#imp-sim-卡安全及挑战响应协议"></a> [IMP] SIM 卡安全及挑战响应协议</h3>
<ol>
<li>手机向本地基站发送 IMSI (国际移动客户身份, International Mobile Subscriber Identity)</li>
<li>基站检查数据库是否存在该 IMSI, 若存在则向手机发送128位随机数</li>
<li>手机使用存储在 SIM 卡中的 128 位密钥对随机数加密, 算法为 A3, 密文发送回基站</li>
<li>基站执行相同的计算, 若两个密文匹配, 则验证成功</li>
<li>SIM 卡通过 A8 算法生成 64 位密钥</li>
<li>此后所有的数据交换使用 A5 算法加密</li>
</ol>
<blockquote>
<p>A3 A5 A8 均为非公开的算法 (违背了开放式设计的原则), 较旧的 SIM 卡通过 COMP128-1 实现它们, 但均已被逆向工程攻破; 新版的称为 COMP128-2, 尚未被攻破</p>
</blockquote>
<p><img src="https://gitee.com/HorizonChaser/pic-bed/raw/master/img/20220102171006.png" srcset="/img/loading.gif" alt="GSM"></p>
<h3 id="针对计算机的直接攻击"><a class="markdownIt-Anchor" href="#针对计算机的直接攻击"></a> 针对计算机的直接攻击</h3>
<ul>
<li>环境攻击和事故: 电力, 温度, 短路 (水灾)</li>
<li>窃听: 搭线窃听 (光纤可以抵御)</li>
<li>射频辐射: 利用逸散的电磁波</li>
<li>光辐射</li>
<li>声音辐射: 例如按键声</li>
<li>硬件键盘记录器: 连接在键盘和计算机之间, 复制键盘输入的内容</li>
</ul>
<h3 id="针对-atm-的攻击"><a class="markdownIt-Anchor" href="#针对-atm-的攻击"></a> 针对 ATM 的攻击</h3>
<ul>
<li>黎巴嫩圈套: 将薄膜套插入卡槽, 欺骗客户发生了吞卡</li>
<li>分离器: 在卡槽上增加复制装置, 复制客户的卡片</li>
</ul>
<h2 id="chapter-3-操作系统的安全"><a class="markdownIt-Anchor" href="#chapter-3-操作系统的安全"></a> Chapter 3 操作系统的安全</h2>
<h3 id="进程的安全"><a class="markdownIt-Anchor" href="#进程的安全"></a> 进程的安全</h3>
<ul>
<li>从开始到结束的传递信任</li>
<li>监控, 管理和日志: 事件日志, 进程查看器等</li>
</ul>
<h3 id="内存和文件系统的安全"><a class="markdownIt-Anchor" href="#内存和文件系统的安全"></a> 内存和文件系统的安全</h3>
<ul>
<li>虚拟内存的安全: 虚拟内存保存了内存的信息, 但位于外部的硬盘上</li>
<li>身份验证: 盐的概念, 原理
<ul>
<li>原理: 引入与用户ID相关的随机数作为哈希函数的输入值来增加搜索空间的大小</li>
<li>方法: 存储用户ID, ID 的盐值, 密码和盐值整体的哈希值</li>
</ul>
</li>
</ul>
<h3 id="imp-应用程序安全-p97"><a class="markdownIt-Anchor" href="#imp-应用程序安全-p97"></a> [IMP] 应用程序安全 [P97]</h3>
<ul>
<li>DLL 注入: 使用动态链接的程序依赖外部的动态链接库 (dll或者so文件), 因此可以通过共享库向程序注入代码</li>
<li>算术溢出: 利用补码表示时, 负数过小可能会溢出为很大的正数</li>
<li>缓冲区溢出攻击: 利用向长度限制不受检查的缓冲区写入大量数据来覆写内存, 进而修改代码或获得控制权限
<ul>
<li>栈溢出 (覆写返回地址或在栈中插入指令串 (常称为 shellcode))</li>
<li>NOP 指令滑动</li>
<li>返回到 libc (利用加载的 libc 库中的函数进行攻击)</li>
<li>堆溢出</li>
</ul>
</li>
<li>格式化字符串攻击 (只给 printf 函数提供格式化字符串这一个参数, 这样它会把栈上的数据作为其余的参数, 原理见 <a target="_blank" rel="noopener" href="https://signalshore.github.io/blog/Stack-Frames-in-x86.html">x86 栈帧</a>)</li>
<li>竞争条件</li>
</ul>
<h2 id="chapter-4-恶意软件"><a class="markdownIt-Anchor" href="#chapter-4-恶意软件"></a> Chapter 4 恶意软件</h2>
<h3 id="内部攻击的基本方式"><a class="markdownIt-Anchor" href="#内部攻击的基本方式"></a> 内部攻击的基本方式</h3>
<ul>
<li>后门: 程序中隐藏的功能或命令</li>
<li>逻辑炸弹: 根据特定的条件触发而已操作</li>
<li>防御方式
<ul>
<li>避免单点故障, 不只让一个人负责重要系统</li>
<li>代码交叉检查</li>
<li>归档, 日志和报告</li>
<li>限制权限和授权</li>
<li>物理安全</li>
<li>监控员工与机器的行为</li>
</ul>
</li>
</ul>
<h3 id="imp-计算机病毒-木马和蠕虫-p120"><a class="markdownIt-Anchor" href="#imp-计算机病毒-木马和蠕虫-p120"></a> [IMP] 计算机病毒, 木马和蠕虫 [P120]</h3>
<ul>
<li>病毒四个阶段: 潜伏, 繁殖, 触发, 行动</li>
<li>病毒类型
<ul>
<li>文件病毒 (程序病毒): 修改文件包含的对象代码</li>
<li>宏病毒 (文档病毒): 利用编辑器的宏功能, 当打开文档时启动病毒, 可以感染其他文档</li>
<li>引导区病毒: 修改引导区的代码, 这样每次系统启动或重启时都会运行病毒</li>
</ul>
</li>
<li>病毒防御
<ul>
<li>特征码: 计算已知病毒的数字指纹, 然后对所有文件进行模式匹配</li>
<li>检测与隔离</li>
</ul>
</li>
<li>木马: 表面上执行有用的任务, 但会隐形地执行攻击任务</li>
<li>蠕虫: 不是计算机病毒, 不会感染其他程序, 通过传播自己的副本来扩散</li>
</ul>
<h3 id="rootkits"><a class="markdownIt-Anchor" href="#rootkits"></a> Rootkits</h3>
<ul>
<li>特别的, 隐形的恶意软件</li>
<li>通过修改系统程序或系统本身来防止检测
<ul>
<li>例如使用钩子函数 (修改特定的函数)</li>
</ul>
</li>
<li>可以通过对系统文件进行校验来检测</li>
</ul>
<h3 id="零日攻击"><a class="markdownIt-Anchor" href="#零日攻击"></a> 零日攻击</h3>
<blockquote>
<p>就是经常看到的 0-day attack</p>
</blockquote>
<ul>
<li>利用此前未知或未公开的脆弱性进行攻击</li>
<li>特征码不能识别, 需要启发式的检测方法</li>
</ul>
<h3 id="僵尸网络"><a class="markdownIt-Anchor" href="#僵尸网络"></a> 僵尸网络</h3>
<ul>
<li>大量的被恶意软件控制的计算机组成的网络</li>
</ul>
<h3 id="入侵隐私软件"><a class="markdownIt-Anchor" href="#入侵隐私软件"></a> 入侵隐私软件</h3>
<ul>
<li>目标是用户的隐私或其他有价值的信息</li>
<li>例如广告软件, 间谍软件等</li>
</ul>
<h2 id="imp-chapter-5-网络安全-i"><a class="markdownIt-Anchor" href="#imp-chapter-5-网络安全-i"></a> [IMP] Chapter 5 网络安全 I</h2>
<h3 id="互联网的分层"><a class="markdownIt-Anchor" href="#互联网的分层"></a> 互联网的分层</h3>
<p>IP 的五层和 OSI 的七层, 直接看计网的图</p>
<p><img src="https://gitee.com/HorizonChaser/pic-bed/raw/master/img/20210616190804.png" srcset="/img/loading.gif" alt="Layers"></p>
<h3 id="以太网的概念"><a class="markdownIt-Anchor" href="#以太网的概念"></a> 以太网的概念</h3>
<p>既是指所用的物理介质 (通常来说是线缆), 也指链路层协议标准 IEEE 802.3</p>
<h3 id="imp-arp-欺骗-p155"><a class="markdownIt-Anchor" href="#imp-arp-欺骗-p155"></a> [IMP] ARP 欺骗 [P155]</h3>
<p>ARP 概念见 <a href="https://horizonchaser.github.io/2021/06/13/CS-Network-Review-and-Summary/#arp">计网复习-ARP</a></p>
<p>对于攻击目标的 ARP 请求, 如果我们能够在真正的目标计算机回应前抢先回复自己的 MAC 地址, 就可以修改攻击目标的 IP-MAC 映射表, 进而截获它的数据包, 由此可以进行中间人攻击.</p>
<ul>
<li>利用的 ARP 协议无身份验证的缺陷</li>
<li>可用静态 ARP 表防御 (提前指定好 IP-MAC 映射关系)</li>
</ul>
<h3 id="imp-ip-协议与-icmp-协议-p157"><a class="markdownIt-Anchor" href="#imp-ip-协议与-icmp-协议-p157"></a> [IMP] IP 协议与 ICMP 协议 [P157]</h3>
<p>详细的参见 <a href="https://horizonchaser.github.io/2021/06/13/CS-Network-Review-and-Summary/#chapter-20-ip%E5%8D%8F%E8%AE%AE">计网复习-IP</a> 和 <a href="https://horizonchaser.github.io/2021/06/13/CS-Network-Review-and-Summary/#icmp">计网复习</a></p>
<p>IP 协议:</p>
<ul>
<li>在网络层</li>
<li>尽力转发</li>
<li>存在子网掩码的概念</li>
</ul>
<p>ICMP 协议:</p>
<ul>
<li>网际控制消息协议</li>
<li>主要用于网络诊断消息</li>
<li>包含回显请求, 回显响应, 超时 (到达 TTL 限制, 数据包已不能继续传递), 目的不可达等</li>
<li>ping, tracert 依赖 ICMP 协议</li>
</ul>
<h3 id="imp-ip-地址欺骗-p161"><a class="markdownIt-Anchor" href="#imp-ip-地址欺骗-p161"></a> [IMP] IP 地址欺骗 [P161]</h3>
<ul>
<li>操作系统基本都提供了使用任意 IP 头信息发送报文的接口</li>
<li>IP 欺骗时, 发起者不能直接接收到返回的报文
<ul>
<li>因为他的 IP 地址是伪造的</li>
<li>不过对于一些场合, 例如拒绝服务攻击没啥影响, 因为这时我们也不关心返回的内容</li>
</ul>
</li>
<li>可以通过配置路由器来阻止
<ul>
<li>例如阻止转发源地址在域内, 但实际地址在域外的数据包</li>
</ul>
</li>
</ul>
<h3 id="数据包嗅探"><a class="markdownIt-Anchor" href="#数据包嗅探"></a> 数据包嗅探</h3>
<ul>
<li>由于大多数 IP 数据包没有加密, 因此可以进行嗅探 (获得同一网络下的流量)</li>
<li>网络接口在混杂模式下运行时, 会保留所有的帧而不检查 MAC 地址</li>
<li>使用交换机缩小网段可以缓解嗅探攻击</li>
</ul>
<h3 id="传输层协议"><a class="markdownIt-Anchor" href="#传输层协议"></a> 传输层协议</h3>
<p><a href="https://horizonchaser.github.io/2021/06/13/CS-Network-Review-and-Summary/#tcp-imp">TCP</a> 和 <a href="https://horizonchaser.github.io/2021/06/13/CS-Network-Review-and-Summary/#udp">UDP</a>, 细节看链接</p>
<p>TCP:</p>
<ul>
<li>Transmission Control Protocol, 传输控制协议</li>
<li>有流量控制, 通过滑动窗口协议实现</li>
<li>有拥塞控制</li>
<li>连接有状态, 有重传</li>
</ul>
<p>UDP:</p>
<ul>
<li>User Datagram Protocol, 用户数据报协议</li>
<li>无流量控制</li>
<li>无拥塞控制</li>
<li>连接无状态, 无重传</li>
</ul>
<h3 id="imp-tcp-会话劫持-p168"><a class="markdownIt-Anchor" href="#imp-tcp-会话劫持-p168"></a> [IMP] TCP 会话劫持 [P168]</h3>
<ul>
<li>会话欺骗: 创建伪造的会话
<ul>
<li>尝试预测服务器给出的 SYN+ACK (第二次握手) 中的序列号, 然后作为 ACK (第三次握手) 的确认号, 并配合 IP 地址伪造</li>
<li>如果成功, 可以以受害者的 IP 地址的身份和服务器建立连接</li>
<li>由于初始序列号的产生是可预测的, 因此攻击是可能的</li>
</ul>
</li>
<li>盲注入: 使用 IP 伪造, 无法接受回应, 但可以使用请求者的 IP 地址对应的身份执行命令</li>
<li>ACK 风暴: 盲注入后双方会尝试同步, 会循环发送大量 ACK</li>
<li>完全会话劫持: 利用嗅探获取序列号, 可以配合 ARP 欺骗实现中间人攻击</li>
</ul>
<h3 id="imp-拒绝服务攻击-p170"><a class="markdownIt-Anchor" href="#imp-拒绝服务攻击-p170"></a> [IMP] 拒绝服务攻击 [P170]</h3>
<blockquote>
<p>Denial of Service, DoS, 拒绝服务攻击</p>
</blockquote>
<p>利用连接容量有限的特点, 发起大量连接使得服务器无法运行</p>
<p>可以配合 IP 地址伪造</p>
<h3 id="imp-ip-地址回溯-p175"><a class="markdownIt-Anchor" href="#imp-ip-地址回溯-p175"></a> [IMP] IP 地址回溯 [P175]</h3>
<ul>
<li>尝试确定数据包的真实来源 (因为源 IP 可能是伪造的)</li>
<li>利用数据包标记: 每个路由器都是概率性地 (或确定性地) 对数据包做出标记
<ul>
<li>这样, 若被最接近受害者路由器标记的概率为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span>, 则被上一层标记的概率应当为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo>×</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p \times (1-p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mclose">)</span></span></span></span></li>
<li>通过比例递推可以确定路径</li>
</ul>
</li>
<li>实际中能够实现的很少, 因为实际上是在网络层解决网络层的认证问题</li>
</ul>
<blockquote>
<p>想想也是, 这成功听起来就是概率性的</p>
</blockquote>
<h2 id="imp-chapter-6-网络安全-ii-p180"><a class="markdownIt-Anchor" href="#imp-chapter-6-网络安全-ii-p180"></a> [IMP] Chapter 6 网络安全 II [P180]</h2>
<h3 id="imp-dns-原理-p183"><a class="markdownIt-Anchor" href="#imp-dns-原理-p183"></a> [IMP] DNS 原理 [P183]</h3>
<blockquote>
<p>DNS, Domain Name System, 域名系统</p>
</blockquote>
<ul>
<li>DNS 用来实现域名 (例如 <a target="_blank" rel="noopener" href="http://www.example.com">www.example.com</a>) 和 IP 地址 (<code>93.184.216.34</code> 或者 <code>2606:2800:220:1:248:1893:25c8:1946</code>, 后者是 IPv6 地址) 间的映射
<ul>
<li>后者到前者称为反向查询</li>
</ul>
</li>
<li>DNS 是分层的, 从上往下是根域名服务器, 权威域名服务器, 非权威域名服务器</li>
<li>查询过程 (以 <a target="_blank" rel="noopener" href="http://www.example.com">www.example.com</a> 为例, 递归方式):
<ul>
<li>首先, 客户端和自己保存的 DNS 服务器 S 查询 (通常是 ISP 分配的, 也可手动指定)</li>
<li>S 检查缓存, 如果有且没过期直接返回, 否则开始递归查询</li>
<li>S 首先向根域名服务器发送 DNS 查询, 得到 .com 的权威域名服务器的地址</li>
<li>S 继续向 .com 的域名服务器查询 <a target="_blank" rel="noopener" href="http://example.com">example.com</a>, 得到 <a target="_blank" rel="noopener" href="http://example.com">example.com</a> 域名服务器的地址</li>
<li>S 继续查询, 得到 <a target="_blank" rel="noopener" href="http://www.example.com">www.example.com</a> 的地址</li>
<li>S 缓存这个来之不易的结果, 然后给客户端返回</li>
</ul>
</li>
</ul>
<h3 id="imp-dns-攻击-p185"><a class="markdownIt-Anchor" href="#imp-dns-攻击-p185"></a> [IMP] DNS 攻击 [P185]</h3>
<ul>
<li>将正确的域名指向错误的 IP 地址</li>
<li>DNS 缓存中毒: 欺骗并使其缓存错误的结果
<ul>
<li>例如要针对 x.y 域名进行攻击:
<ul>
<li>首先对 DNS 服务器发送查询 x.y 的请求</li>
<li>利用 IP 地址伪造, 伪装成权威域名服务器的源地址, 向 DNS 服务器发送恶意的 IP 地址 p, p 是一个恶意的 DNS 服务器, 会把地址解析到钓鱼网站等</li>
<li>DNS 服务器缓存了错误的结果, 现在对于 y 的请求都会被 p 操控</li>
<li>利用了 DNS 协议无身份验证的缺陷 (后来有了 DNSSec)</li>
</ul>
</li>
<li>对客户端也可发动</li>
</ul>
</li>
</ul>
<h3 id="防火墙技术"><a class="markdownIt-Anchor" href="#防火墙技术"></a> 防火墙技术</h3>
<ul>
<li>防火墙对数据包的处理方式: 接受, 丢弃 (不允许通过且无失败指示), 拒绝 (不允许通过且有失败提示)</li>
<li>无状态防火墙: 只针对当前正在处理的数据包, 不维护任何上下文
<ul>
<li>开销小, 实现简单, 不能区分当前数据包是否是对前一个特定数据报的响应</li>
</ul>
</li>
<li>有状态防火墙: 记录每个连接的信息
<ul>
<li>可以实行更严格的管控, 可以实现深度数据包检测</li>
</ul>
</li>
</ul>
<h3 id="imp-隧道-p195"><a class="markdownIt-Anchor" href="#imp-隧道-p195"></a> [IMP] 隧道 [P195]</h3>
<ul>
<li>在客户端和服务器端自动加解密</li>
<li>不需要修改应用程序</li>
<li>增加了 IP 协议栈的开销</li>
</ul>
<h4 id="imp-安全的-shell-p196"><a class="markdownIt-Anchor" href="#imp-安全的-shell-p196"></a> [IMP] 安全的 Shell [P196]</h4>
<blockquote>
<p>Secure Shell, SSH, 即安全的 Shell</p>
</blockquote>
<ul>
<li>建立了一个安全的隧道</li>
<li>建立方式:
<ul>
<li>客户端通过 TCP 连接到服务器, 交换连接信息 (加密算法, 协议版本等)</li>
<li>进行密钥交换, 创建共享的秘密会话密钥 (注意不是加密算法), 并加密之后所有的通信 (通常用块加密, 例如 AES, Blowfish 等)</li>
<li>服务器向客户端发送可接受的身份验证方法, 客户端进行尝试
<ul>
<li>如果是公钥认证, 客户端向服务器发送自己保存的公钥</li>
<li>服务器检查该公钥是否在自己存储的已授权的密钥列表中
<ul>
<li>如果不在则要求客户端换个公钥 (这个公钥不是对这台服务器的)</li>
<li>如果在, 则使用公钥加密挑战 (一个随机的字符串)</li>
<li>客户端使用私钥解密挑战, 并向服务器返回响应</li>
<li>若两者结果一致, 则身份验证成功, 服务器允许客户端访问</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="imp-ipsec-p197"><a class="markdownIt-Anchor" href="#imp-ipsec-p197"></a> [IMP] IPSec [P197]</h4>
<ul>
<li>配合 IPv6, 但是 IPv4 也可使用</li>
<li>两种模式: 传输模式, 隧道模式
<ul>
<li>传输模式: 在原数据包的有效载荷前插入 IPSec 头信息, 只对有效载荷进行加密或验证</li>
<li>隧道模式: 构建新的数据包, 将 IPSec 头信息和整个原数据包作为新数据包的有效载荷
<ul>
<li>常用于创建 VPN</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="虚拟专用网络"><a class="markdownIt-Anchor" href="#虚拟专用网络"></a> 虚拟专用网络</h3>
<blockquote>
<p>Virtual Private Network, VPN</p>
</blockquote>
<ul>
<li>远程访问 VPN: 允许在互联网另一端的用户访问内网</li>
<li>站点到站点的 VPN: 安全地桥接两个网络</li>
<li>结合隧道技术, 可以对数据进行封装与加密, 避免防火墙的检测
<ul>
<li>但防火墙仍然可以直接阻断</li>
</ul>
</li>
</ul>
<h3 id="入侵检测"><a class="markdownIt-Anchor" href="#入侵检测"></a> 入侵检测</h3>
<blockquote>
<p>入侵检测系统, IDS, Intrusion Detection System</p>
</blockquote>
<ul>
<li>实时地检测威胁</li>
<li>传统的网络入侵检测: 位于边界, 基于流量和内容</li>
<li>基于协议的入侵检测系统: 专门检测特定协议的恶意行为</li>
<li>基于主机的入侵检测系统: 检测单个主机上的活动</li>
<li>存在误报和漏报</li>
</ul>
<h2 id="chapter-7-web-安全"><a class="markdownIt-Anchor" href="#chapter-7-web-安全"></a> Chapter 7 Web 安全</h2>
<h3 id="网络钓鱼"><a class="markdownIt-Anchor" href="#网络钓鱼"></a> 网络钓鱼</h3>
<ul>
<li>利用用户不会仔细检查网页的特点, 创建与真实页面十分相似的虚假页面</li>
<li>伪造的 URL 一般与真实网站不同 (除非对 DNS 或缓存进行攻击), 但十分相似 (利用 Unicode 中相似的字符) -&gt; URL 混淆</li>
<li>点击劫持: 看上去是 A 的超链接, 但实际指向 B</li>
<li>利用媒体内容的脆弱性 (例如 Flash, ActiveX 控件 和 Java Applet)</li>
</ul>
<h3 id="imp-xss-跨站脚本-p239"><a class="markdownIt-Anchor" href="#imp-xss-跨站脚本-p239"></a> [IMP] XSS (跨站脚本) [P239]</h3>
<blockquote>
<p>cross-Site Scripting, XSS</p>
</blockquote>
<ul>
<li>通过未经过滤的输入向网站上注入代码
<ul>
<li>利用 JavaScript</li>
</ul>
</li>
<li>持久性 XSS: 攻击者注入的代码会在网站上保留一段时间, 且对其他用户可见</li>
<li>非持久性 XSS: 注入的代码不会持久保留</li>
<li>可以窃取用户的 Cookie, 重定向到恶意网站等</li>
<li>通过过滤和检测可以防御</li>
</ul>
<h3 id="跨站请求伪造"><a class="markdownIt-Anchor" href="#跨站请求伪造"></a> 跨站请求伪造</h3>
<blockquote>
<p>CSRF, Cross-Site Request Foegery</p>
</blockquote>
<ul>
<li>利用网站信任的特定用户</li>
<li>让受害者在不知情的情况下在恶意网站上执行命令, 然后恶意网站向受攻击的网站发送恶意请求</li>
</ul>
<h3 id="imp-sql-注入-p251"><a class="markdownIt-Anchor" href="#imp-sql-注入-p251"></a> [IMP] SQL 注入 [P251]</h3>
<ul>
<li>利用拼接 SQL 查询时不对某些字段的值进行校验的漏洞, 构造能获取 (或修改) 其他信息的查询</li>
<li>可以删库跑路, 还可以绕过身份验证</li>
<li>可以检查输入是否为合法的值, 并去除危险字符 (例如引号和斜杠等) 来防御</li>
</ul>
<h2 id="chapter-8-加密-密码学概述"><a class="markdownIt-Anchor" href="#chapter-8-加密-密码学概述"></a> Chapter 8 加密 (密码学概述)</h2>
<h3 id="对密码系统攻击的类型"><a class="markdownIt-Anchor" href="#对密码系统攻击的类型"></a> 对密码系统攻击的类型</h3>
<ul>
<li>唯密文攻击: 已拥有一个或多个使用相同的密钥加密的密文</li>
<li>已知明文攻击: 已拥有一个或多个使用相同的密钥的明文-密文对</li>
<li>选择明文攻击: 可以选择一个或多个明文, 根据相同的密钥得到各自对应的密文
<ul>
<li>离线选择明文攻击: 必须事先选择好所有的明文</li>
<li>自适应选择明文攻击: 可以以迭代的形式逐个选择明文</li>
</ul>
</li>
<li>选择密文攻击: 选择一个或多个使用相同密钥得到的密文, 得到各自对应的明文
<ul>
<li>同样有离线和自适应的版本</li>
</ul>
</li>
</ul>
<h3 id="替换密码和频率分析"><a class="markdownIt-Anchor" href="#替换密码和频率分析"></a> 替换密码和频率分析</h3>
<ul>
<li>替换密码: 将每个字母按规律替换为其他字母
<ul>
<li>例如凯撒密码</li>
<li>若替换单位是字母组, 则为多字母替换密码, 替换规律称为替换盒, 或称 <strong>S 盒</strong></li>
</ul>
</li>
<li>维吉尼亚密码: 利用密钥决定不同字母替换时的偏移量
<ul>
<li>例如密钥为<code>XYZ</code>, 则分别用<code>X</code> <code>Y</code> <code>Z</code>三行的偏移量进行替换</li>
<li>同样是替换密码 (相当于按照密钥长度分段, 段内的不同字母间是偏移量不同的凯撒密码, 但<strong>段间偏移量的模式相同</strong>)</li>
<li>如果密文中出现了相同的模式, 则根据重复部分间隔的长度可以推断出可能的密钥长度, 进而按照凯撒密码进行破解</li>
</ul>
</li>
<li>频率分析: 不同字母在文本中出现的概率通常不等</li>
</ul>
<h3 id="一次一密-otp"><a class="markdownIt-Anchor" href="#一次一密-otp"></a> 一次一密 (OTP)</h3>
<blockquote>
<p>OTP, One-Time Pad, 一次性密码本 (注意不是一次性密码 Password, 这是不同的概念)</p>
</blockquote>
<ul>
<li>如果能做到以下两点, 则无法进行频率分析
<ul>
<li>密钥块的长度与明文长度相等 (单次加密不需要反复循环使用同一个密钥)</li>
<li>每次的偏移量完全随机, 即密钥不重复</li>
</ul>
</li>
<li>这就是一次性密码<strong>本</strong></li>
<li>弱点: 必须要求密钥完全不重用</li>
</ul>
<h3 id="分组密码"><a class="markdownIt-Anchor" href="#分组密码"></a> 分组密码</h3>
<blockquote>
<p>Block Cipher, 也称作块密码</p>
</blockquote>
<p>将明文划分为固定大小的分组 (如果最后一个分组长度不够, 通常会用特定算法补齐, 例如<code>PKCS5</code>, <code>PKCS7</code> 等), 然后对分组进行操作</p>
<h3 id="aes-算法"><a class="markdownIt-Anchor" href="#aes-算法"></a> AES 算法</h3>
<blockquote>
<p>AES, Advanced Encryption Standard, 高级加密标准</p>
</blockquote>
<ul>
<li><strong>是分组密码</strong>, 分组大小固定为 128 位</li>
<li>密钥长度可以是 128, 192 或者 256 位</li>
<li>一共有十轮处理, 每轮包含四步:
<ul>
<li>S-盒替换</li>
<li>置换 (移动行)</li>
<li>矩阵乘法 (打乱列)</li>
<li>使用从密钥派生的轮密钥进行异或</li>
</ul>
</li>
<li>为了加速计算, 使用了查找表实现从字节到整数的映射
<ul>
<li>存在定时攻击的可能: Cache 会保存存储表中使用了的表项, 这时访问这些表项比访问不在 Cache 中的快</li>
<li>可以让 AES 的执行时间固定来防御定时攻击</li>
</ul>
</li>
<li>仅有旁路攻击 (侧信道攻击) 是对 AES 的实际攻击</li>
</ul>
<h3 id="分组密码的操作模式"><a class="markdownIt-Anchor" href="#分组密码的操作模式"></a> 分组密码的操作模式</h3>
<ul>
<li>电子密码本模式 (ECB): Electronic CodeBook mode
<ul>
<li>对每个分组进行独立加密</li>
<li>优点: 简单, 可允许分组丢失</li>
<li>缺点: 相同的分组加密后的内容相同, 分组数量较多时会泄露明文的模式</li>
</ul>
</li>
<li>密码分组链接 (CBC): Cipher-Block Chaining mode
<ul>
<li>第一个分组先和初始化向量 (Initialization Vector, IV) 异或, 然后再加密; 此后的每一个分组先和上一个分组的密文异或再加密</li>
<li>优点: 不会泄露明文的模式, 可允许分组丢失</li>
<li>缺点: 必须顺序加密 (但是可以并行解密, 因为异或依赖的是密文)</li>
</ul>
</li>
<li>密码反馈 (CFB): Cipher FeedBack mode
<ul>
<li>类似 CBC, 但是先加密前一个密文, 然后再和这个明文分组异或作为密文</li>
<li>优点: 比 CBC 快</li>
</ul>
</li>
<li>输出反馈 (OFB): Output FeedBack mode
<ul>
<li>从初始化向量开始, 加密后作为下一个向量; 每一级的明文和对应的向量异或作为密文</li>
<li>优点: 能容忍密文丢失, 如果能有向量序列则加解密均可并行</li>
</ul>
</li>
<li>计数器模式 (CTR): CounTeR mode
<ul>
<li>类似 OFB, 从一个随机种子 s 开始, 第 i 个偏移向量是 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>V</mi><mi>i</mi></msub><mo>=</mo><msub><mi>E</mi><mi>k</mi></msub><mo stretchy="false">(</mo><mi>s</mi><mo>+</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">V_i = E_k(s+i-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span>, 明文和向量异或后作为密文</li>
<li>优点: 向量的生成和加解密均可并行, 可容忍分组丢失</li>
</ul>
</li>
</ul>
<h3 id="流密码"><a class="markdownIt-Anchor" href="#流密码"></a> 流密码</h3>
<ul>
<li>将明文看作字符串或者二进制位串, 然后逐字符或逐位进行加密 (简单的异或即可)</li>
<li>为了防止密钥穷举, 使用和明文一样长的密钥流</li>
<li>重点在于如何从有限长度的密钥中产生任意长度的密钥流, 例如使用线性同余发生器</li>
</ul>
<h3 id="数论基础"><a class="markdownIt-Anchor" href="#数论基础"></a> 数论基础</h3>
<h4 id="辗转相除法-欧几里得算法"><a class="markdownIt-Anchor" href="#辗转相除法-欧几里得算法"></a> 辗转相除法 (欧几里得算法)</h4>
<ul>
<li>用来计算两个数 a b 的最大公约数 (GCD, Greatest Common Divisor)</li>
<li>原理: 两个整数的最大公约数等于其中较小的那个数和两数相除余数的最大公约数, 即 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mi>b</mi><mo separator="true">,</mo><mi>a</mi><mspace></mspace><mspace width="0.6666666666666666em"></mspace><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">gcd(a, b) = gcd(b, a \mod b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">c</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">c</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.6666666666666666em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span></span></span></span></li>
<li>步骤:
<ul>
<li>设 a &gt; b, 判断 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mspace></mspace><mspace width="0.6666666666666666em"></mspace><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>b</mi><mo>=</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">a \mod b == 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.6666666666666666em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> 是否成立
<ul>
<li>若否, 则让 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mo>=</mo><mi>a</mi><mspace></mspace><mspace width="0.6666666666666666em"></mspace><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>b</mi></mrow><annotation encoding="application/x-tex">b = a \mod b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.6666666666666666em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span></span></span></span>, a 为 b 的初值</li>
<li>若是, 则 b 为 GCD</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="费马定理和欧拉定理"><a class="markdownIt-Anchor" href="#费马定理和欧拉定理"></a> 费马定理和欧拉定理</h4>
<ul>
<li>费马小定理: 设 p 为素数, g 为小于 p 的任意正整数, 则 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>g</mi><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msup><mspace></mspace><mspace width="0.6666666666666666em"></mspace><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>p</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">g^{p-1} \mod p = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.6666666666666666em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></li>
<li>欧拉定理: x, n 为任意正整数, 且互质, 则 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mrow><mi mathvariant="normal">Φ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow></msup><mspace></mspace><mspace width="0.6666666666666666em"></mspace><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>n</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x^{\Phi(n)} \mod n = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Φ</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">n</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.6666666666666666em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Φ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Phi(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Φ</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 称作欧拉函数, 它的值等于 “不大于 n 的范围中的素数的个数”</li>
<li>欧拉定理是费马小定理的扩展</li>
</ul>
</li>
</ul>
<h3 id="rsa-算法"><a class="markdownIt-Anchor" href="#rsa-算法"></a> RSA 算法</h3>
<ul>
<li>密钥产生:
<ul>
<li>公钥: 选择两个大素数 p q, 令 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>=</mo><mi>p</mi><mo>×</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">n = p \times q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span>, 选择一个和 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Φ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Phi(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Φ</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 互质的数 e, 计算 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mo>=</mo><msup><mi>e</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mspace></mspace><mspace width="0.6666666666666666em"></mspace><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi mathvariant="normal">Φ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d = e^{-1} \mod \Phi(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.6666666666666666em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">Φ</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>, 则公钥为 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>e</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(e, n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> 对
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Φ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>n</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mfrac><mn>1</mn><msub><mi>p</mi><mn>1</mn></msub></mfrac><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mfrac><mn>1</mn><msub><mi>p</mi><mn>2</mn></msub></mfrac><mo stretchy="false">)</mo><mo>⋯</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mfrac><mn>1</mn><msub><mi>p</mi><mi>n</mi></msub></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Phi(n) = n(1-\frac{1}{p_1})(1-\frac{1}{p_2})\cdots(1-\frac{1}{p_n})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Φ</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.326216em;vertical-align:-0.481108em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.481108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.326216em;vertical-align:-0.481108em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.481108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.326216em;vertical-align:-0.481108em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.481108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span>, 其中<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">p_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为 n 的质因子</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mo>×</mo><mi>e</mi><mspace></mspace><mspace width="0.6666666666666666em"></mspace><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi mathvariant="normal">Φ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>≡</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">d\times e \mod \Phi(n) \equiv 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">e</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.6666666666666666em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">Φ</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></li>
<li>n 的二进制长度即为位数, 通常为 1024 或者 2048 位</li>
<li>实际中 e 常取值 65537</li>
</ul>
</li>
<li>私钥: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>n</mi><mo separator="true">,</mo><mi>d</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(n, d)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">d</span><span class="mclose">)</span></span></span></span> 对为私钥</li>
</ul>
</li>
<li>加密过程: 设明文为 M, 密文为 C, 则 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mo>=</mo><msup><mi>M</mi><mi>e</mi></msup><mspace></mspace><mspace width="0.6666666666666666em"></mspace><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">C = M^e \mod n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">e</span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.6666666666666666em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span></span></span></span></li>
<li>解密过程: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>M</mi><mo>=</mo><msup><mi>C</mi><mi>d</mi></msup><mspace></mspace><mspace width="0.6666666666666666em"></mspace><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mtext> </mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">M = C^d \mod n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">d</span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.6666666666666666em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span></span></span></span></li>
</ul>
<h3 id="散列函数-哈希函数"><a class="markdownIt-Anchor" href="#散列函数-哈希函数"></a> 散列函数 (哈希函数)</h3>
<ul>
<li>将输入 (通常称为"消息") 映射到固定长度的输出字符串, 同时提供确定性, 单向性和抗冲突性</li>
<li>抗冲突性: 由于输出长度可以大于输出长度, 所以必定存在冲突
<ul>
<li>强抗冲突性: 很难构造两个不同的输入, 使得输出一样</li>
<li>弱抗冲突性: 很难构造一个输入, 使得输出等于一个已知的输入的输出</li>
</ul>
</li>
<li>存在针对 MD5 的攻击, 对于两个不同的输入可以构造两个后缀, 使得两组 (消息+后缀) 的哈希值一样</li>
</ul>
<h3 id="生日攻击"><a class="markdownIt-Anchor" href="#生日攻击"></a> 生日攻击</h3>
<ul>
<li>用来攻击哈希函数</li>
<li>对于输出为 b 位的哈希函数 H, 可能的输出有 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mi>b</mi></msup></mrow><annotation encoding="application/x-tex">2^b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span></span></span></span></span></span></span></span> 种</li>
<li>但如果生成大量的随机消息并计算散列值, 则找到两条散列值一样的消息实际上和两个人生日一样的原理相同</li>
<li>所以尝试的消息数可以降低到 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mn>2</mn><mrow><mi>b</mi><mi mathvariant="normal">/</mi><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">2^{b/2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="mord mtight">/</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></li>
<li>因此, 通常根据输出大小的一半来考虑加密散列函数的安全, 例如输出为 256 位的 H 安全性是 128 位</li>
</ul>
<p>具体来说, 对于输出为 b 位的哈希函数 H, 可能的输出有 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mo>=</mo><msup><mn>2</mn><mi>b</mi></msup></mrow><annotation encoding="application/x-tex">m = 2^b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.849108em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span></span></span></span></span></span></span></span> 种</p>
<p>则攻击者生成的第 i 个消息与前面 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(i-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span> 条消息冲突的概率为 $$1-\frac{i-1}{m}$$</p>
<p>在 k 轮后, 仍然没有冲突的概率为 $$F_k = (1-\frac{1}{m}) + (1-\frac{2}{m}) + \dots + (1-\frac{k-1}{m})$$</p>
<p>考虑到 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo>−</mo><mi>x</mi><mo>≈</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>x</mi></mrow></msup></mrow><annotation encoding="application/x-tex">1-x \approx e^{-x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.48312em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.771331em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span></span></span></span>, 则 $$F_k \approx e ^{-(\frac{1}{m} + \frac{2}{m} + \dots + \frac{k-1}{m})} = e^{\frac{k(k-1)}{m}}$$</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>F</mi><mi>k</mi></msub><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">F_k = 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">5</span></span></span></span>, 即成功概率达到一半时, 代入上式得 $$k \approx 1.17 \sqrt{m}$$</p>
<p>而 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msqrt><mi>m</mi></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.23972em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8002800000000001em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathdefault">m</span></span></span><span style="top:-2.76028em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,
-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,
-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,
35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,
-221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467
s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422
s-65,47,-65,47z M834 80H400000v40H845z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.23972em;"><span></span></span></span></span></span></span></span></span> 的二进制位数是 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mi>b</mi><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{b}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>, 也就是输出位数的一半, 证明了生日攻击的存在</p>
<h3 id="消息认证码"><a class="markdownIt-Anchor" href="#消息认证码"></a> 消息认证码</h3>
<blockquote>
<p>消息认证码, Message Authentication Code, 和 MAC 地址没关系</p>
</blockquote>
<ul>
<li>确保不安全信道所传输的消息的完整性和机密性</li>
<li>普通的哈希函数不能直接用作消息认证函数
<ul>
<li>设密钥为 K, 消息为 M, 将 (K||M), (M||K), (K||M||K) 作为输入都是不安全的</li>
</ul>
</li>
<li>基于哈希函数的消息认证码 (HMAC) 可以解决
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>K</mi><mo>⊕</mo><mi>A</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>H</mi><mo stretchy="false">(</mo><mi>K</mi><mo>⊕</mo><mi>B</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi>M</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H(K \oplus A || H(K \oplus B || M))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">A</span><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord">∣</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span>, 其中 A B 为常数</li>
<li>安全性等价于底层使用的哈希函数 H 的安全性</li>
</ul>
</li>
<li>哈希链: 从随机数 r 开始重复进行密码学哈希计算
<ul>
<li>得到的序列是伪随机的</li>
<li>可用作一次一密的密码 (One Time Password)</li>
<li>推广可得哈希树</li>
</ul>
</li>
<li>验证链: 作为增量数据的验证方案
<ul>
<li>设 x 为认证码, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x_{n+1} = 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><msub><mi>P</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mrow><mi>x</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>w</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>e</mi><mtext>&nbsp;</mtext><mi>i</mi><mo>∈</mo><mo stretchy="false">(</mo><mi>n</mi><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x_i = H(P_i||x_{x+1}), where \ i \in (n, \dots , 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mspace">&nbsp;</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li>
<li>首先传输签名 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">x_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>然后传输数据包 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><msub><mi>P</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>x</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(P_i, x_{i+1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>, P 为信息, 每个数据包包含下一个包的哈希值</li>
<li>每个哈希值的完整性需要余下的哈希值作为保证</li>
<li>常数级开销 (每个明文一次哈希)</li>
</ul>
</li>
</ul>
<h2 id="chapter-9-安全模型与实践"><a class="markdownIt-Anchor" href="#chapter-9-安全模型与实践"></a> Chapter 9 安全模型与实践</h2>
<h3 id="kerberos-架构"><a class="markdownIt-Anchor" href="#kerberos-架构"></a> Kerberos 架构</h3>
<ul>
<li>票据:
<ul>
<li>票据授予票据 (Ticket-Granting Ticket, TGT): 用户和会话密钥的全局标识符</li>
<li>服务票据 (Service Ticket): 对用户的请求进行验证, 确定用户能否使用特定服务</li>
</ul>
</li>
<li>使用独立的, 受信任的第三方作为密钥分发中心 (Key Distribution Center, KDC), 包含两部分
<ul>
<li>身份验证服务器 (Authentication Server, AS), 保存着用户和服务密钥, 对用户提供的密码进行哈希得到用户的密钥</li>
<li>票据授予服务器 (Ticket-Granting Server, TGS)</li>
<li>两部分独立</li>
</ul>
</li>
<li>旨在对整个网络进行集中的身份验证, 即使 KDC 被入侵用户密码仍然保密 (只保存了密码的哈希)</li>
</ul>
<h3 id="kerberos-身份验证"><a class="markdownIt-Anchor" href="#kerberos-身份验证"></a> Kerberos 身份验证</h3>
<p><img src="https://gitee.com/HorizonChaser/pic-bed/raw/master/img/20220106183216.png" srcset="/img/loading.gif" alt="Kerberos Authentication"></p>
<ul>
<li>除了最开始的请求没有明文信息, 不过这个请求本身也不包含敏感信息</li>
<li>所有的票据都有时间戳, 可以抗重放攻击</li>
<li><strong>优点</strong>: 在不安全的网络中仍然安全, 抗重放攻击, 使用对称加密 (更高效)</li>
<li><strong>缺点</strong>: 存在单点故障的可能 (KDC 挂了整个系统就无法工作了), 需要同步时钟 (票据都有时间戳)</li>
</ul>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">读书笔记</a>
                    
                      <a class="hover-with-bg" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%AE%89%E5%85%A8%E5%AF%BC%E8%AE%BA/">计算机安全导论</a>
                    
                      <a class="hover-with-bg" href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-NC-SA 4.0 协议</a> ，转载请注明出处</p>
              
              
                <div class="post-prevnext row">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/08/28/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-%E6%80%BB%E7%BB%93/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">设计模式 总结</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/10/26/%E9%95%BF%E5%AE%89%E6%9D%AF2021-Writeup/">
                        <span class="hidden-mobile">长安杯2021 Writeup</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments">
                
                
  <div id="gitalk-container"></div>
  <script type="text/javascript">
    function loadGitalk() {
      addScript('https://cdn.staticfile.org/blueimp-md5/2.13.0/js/md5.min.js');
      addScript('https://cdn.staticfile.org/gitalk/1.6.2/gitalk.min.js', function () {
        var gitalk = new Gitalk({
          clientID: '3d9d508e12d68104e7e7',
          clientSecret: 'cb441dd114622850fa93f43abcfe8c0497154926',
          repo: 'horizonchaser.github.io',
          owner: 'HorizonChaser',
          admin: "HorizonChaser",
          id: md5(location.pathname),
          language: 'zh-CN',
          labels: ["Gitalk"],
          perPage: 20,
          pagerDirection: 'last',
          createIssueManually: true,
          distractionFreeMode: false
        });
        gitalk.render('gitalk-container');
      });
    }
    waitElementVisible('gitalk-container', loadGitalk);
  </script>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
      <script>
        var now = new Date();
        function createtime() {
          var grt = new Date("10/14/2020 17:38:00");//在此处修改你的建站时间，格式：月/日/年 时:分:秒
          now.setTime(now.getTime() + 250);
          days = (now - grt) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
          hours = (now - grt) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
          if (String(hnum).length == 1) { hnum = "0" + hnum; } minutes = (now - grt) / 1000 / 60 - (24 * 60 * dnum) - (60 * hnum);
          mnum = Math.floor(minutes); if (String(mnum).length == 1) { mnum = "0" + mnum; }
          seconds = (now - grt) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
          snum = Math.round(seconds); if (String(snum).length == 1) { snum = "0" + snum; }
          document.getElementById("timeDate").innerHTML = "Horizon Blog 已经运行 " + dnum + " 天 ";
          document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒 ";
        }
        setInterval("createtime()", 250);
      </script>

      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener">
        <span>Fluid</span></a>
    </div>
    
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/main.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  
    
  



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





  <script  src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: '#post-body',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 3,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "计算机安全导论 复习笔记&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 65,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      searchFunc(path, 'local-search-input', 'local-search-result');
      this.onclick = null
    }
  </script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>



















</body>
</html>
