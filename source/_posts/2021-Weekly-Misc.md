---
title: 2021 Weekly Misc
date: 2021-01-29 15:17:16
excerpt: æ¯å‘¨çš„ Misc ç»ƒä¹ ä¸ Writeup
tags:
- Misc
- BUUCTF
---

##  Week 4, 01/24 - 01/30 BUUCTF

### è¢«å·èµ°çš„æ–‡ä»¶

æ‰“å¼€æµé‡åŒ…, å‘ç°ä¸€äº›FTPåè®®çš„åŒ…, ç”¨`ftp or ftp-data`ç­›é€‰å‡ºæ¥, ç»“æœå¦‚ä¸‹.

![image-20210130110430119](2021-Weekly-Misc/image-20210130110430119.png)

55 å·åŒ…å°±æ˜¯æœåŠ¡å™¨è¿”å›çš„åŒ…å« flag.rar çš„æ•°æ®åŒ…, å³é”®è¯¦æƒ…ä¸­çš„ FTP Data åˆ†ç»„, å¯¼å‡ºåˆ†ç»„å­—èŠ‚æµ. ä»æ–‡ä»¶å¤´çš„`Rar!`å¯ä»¥åˆ¤å®š, è¿™æ˜¯ä¸€ä¸ª rar æ–‡ä»¶.

æ‰“å¼€å¯¼å‡ºçš„æ–‡ä»¶, å‘ç°éœ€è¦å¯†ç , ç”¨ ARCHPR çˆ†ç ´, å¾—åˆ°å››ä½å¯†ç `5790`, è¿›è€Œå¾—åˆ° flag.

`flag{6fe99a5d03fb01f833ec3caa80358fa3}`

#### å¦ä¸€ç§æå–æ•°æ®çš„åšæ³•

ä» [pcapng çš„è§„èŒƒ](https://pcapng.github.io/pcapng/draft-tuexen-opsawg-pcapng.html)ä¸­, æˆ‘ä»¬å¯ä»¥å‘ç°æ•°æ®åŒ…åœ¨æ•è·æ–‡ä»¶ä¸­æ˜¯æ˜æ–‡å­˜å‚¨çš„, åŒæ—¶ FTP çš„æ•°æ®ä¹Ÿæ˜¯æ˜æ–‡ä¼ è¾“çš„, æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ binwalk æˆ–è€… foremost ä» pcapng ä¸­æå–æ–‡ä»¶.

å¦‚æœæå–å‡ºçš„æ–‡ä»¶å¤ªå¤šçš„è¯, ä¹Ÿå¯ä»¥å…ˆå¯¼å‡ºæŒ‡å®šçš„æ•°æ®åŒ…å†å°è¯•æå–.



### [BJDCTF2020] è®¤çœŸä½ å°±è¾“äº†

æ‰“å¼€, æ˜¯ä¸€ä¸ª xls æ–‡ä»¶, ä½†ä¸èƒ½æ­£å¸¸æ˜¾ç¤º.

ä¸è¿‡ xls æ–‡ä»¶æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ª zip å‹ç¼©åŒ…, ç›´æ¥è§£å‹, åœ¨ xl/charts ä¸‹é¢å‘ç°ä¸€ä¸ª flag.txt, æ‰“å¼€å°±æ˜¯ flag...

`flag{M9eVfi2Pcs#}`



### [BJDCTF2020]è—è—è—

æ‰“å¼€, æ˜¯å¼  jpg å›¾ç‰‡, ç”¨ stegsolve çœ‹ä¸€ä¸‹ File Format...

![image-20210130121745206](2021-Weekly-Misc/image-20210130121745206.png)

çœ‹æ¥æ–‡ä»¶æœ«å°¾è—äº†ç‚¹ä¸œè¥¿, ç†Ÿæ‚‰çš„ `50 4B 03 04` - åº”è¯¥æ˜¯ä¸ª zip . æ¯”è¾ƒå¥‡æ€ªçš„æ˜¯, ç”¨ binwalk æ²¡èƒ½è¯†åˆ«åˆ° zip å¤´, åªè¯†åˆ«åˆ°äº†ç»“å°¾...

![image-20210130122312148](2021-Weekly-Misc/image-20210130122312148.png)

ä¸è¿‡å…³ç³»ä¸å¤§, ç”¨ UltraEdit (æˆ–è€…åˆ«çš„ä»€ä¹ˆåå…­è¿›åˆ¶ç¼–è¾‘å™¨)æ‰“å¼€, å®šä½åˆ° zip æ–‡ä»¶å¤´, åœ¨`0xC7EE`çš„ä½ç½®, å†™ä¸ª python è„šæœ¬ä»è¿™é‡Œåˆ‡åˆ†å°±è¡Œ.

æ‰“å¼€åˆ‡åˆ†å¾—åˆ°çš„ zip æ–‡ä»¶, é‡Œé¢æ˜¯ä¸ª docx æ–‡ä»¶, æ‰“å¼€æ‰«ç , å¾—åˆ°flag.

`flag{you are the best!}`



### [GXYCTF2019] ä½›ç³»é’å¹´

æ‰“å¼€å‹ç¼©åŒ…, é‡Œé¢æœ‰ä¸€å¼ å›¾, ä¸€ä¸ª txt, åè€…æ˜¯åŠ å¯†çš„.

![image-20210130151231685](2021-Weekly-Misc/image-20210130151231685.png)

åˆ°è¿™é‡Œ, ä¼šäº§ç”Ÿä¸¤ç§æƒ³æ³•: 

- å‹ç¼©åŒ…çš„å¯†ç åœ¨å›¾é‡Œ, å¾—å…ˆæŠŠå¯†ç æ‰¾åˆ° (é”™äº†)
- **å‹ç¼©åŒ…æ˜¯ä¼ªåŠ å¯†çš„** (è¿™æ‰æ˜¯å¯¹çš„...)

#### é”™è¯¯ç¤ºèŒƒ

ç”¨ stegsolve å°è¯•æ— æœ, å°è¯•ç”¨ zsteg æ£€æµ‹éšå†™æ–¹å¼, å‘ç°ä¸æ”¯æŒ - æ–‡ä»¶å¤´æ˜¯ `FF D8 FF D9`...åŸæ¥æ˜¯ä¸ª jpg  ~~åˆè¢«å‡ºé¢˜äººå¥—è·¯äº†,ä¸‹æ¬¡ä¸€å®šæ³¨æ„å…ˆç”¨fileç¡®è®¤ä¸€ä¸‹~~

ç”¨ stegdetect æ£€æµ‹, ç³»æ•°ä¸º 10.0, æŠ¥å‘Šå¯èƒ½æ˜¯ jphide, ç”¨ stegbreak è·‘å­—å…¸, æœªæœ.

è‡³æ­¤å‘ç°, æ­¤è·¯ä¸é€š...ğŸ˜­

#### æ­£è§£

å› ä¸ºå­˜åœ¨æœªåŠ å¯†çš„æ–‡ä»¶, å› æ­¤ä¸€å®šä¸æ˜¯å…¨å±€ä¼ªåŠ å¯†, å¯èƒ½æ˜¯å•ç‹¬è®¾ç½®äº†æ¯ä¸€ä¸ªæ–‡ä»¶è®°å½•çš„åŠ å¯†ä½.

ç”¨ 010 Editor æ‰“å¼€, å®šä½åˆ° dirEntry[1], ä¹Ÿå°±æ˜¯ fo.txt å¯¹åº”çš„è®°å½•çš„ä½ç½®, å‘ç° [`deFlags`](https://www.jianshu.com/p/8e4209bca4af)æ˜¯`09 00`, å­˜åœ¨ä¼ªåŠ å¯†, ä¿®æ”¹ä¸º`00 00`, æ­£å¸¸è§£å‹å‡ºäº† fo.txt.

![image-20210130152220026](2021-Weekly-Misc/image-20210130152220026.png)

åœ¨æœ€ä¸‹é¢æˆ‘ä»¬å‘ç°äº†è¿™ä¹ˆä¸€ä¸²ä¸œè¥¿.

> ä½›æ›°ï¼šé®ç­‰è«³å‹èƒ½ç¤™çš¤è—å“†å¨‘æ¢µè¿¦ä¾„ç¾…å“†è¿¦æ¢µè€…æ¢µæ¥è˜‡æ¶…ä¾„å®¤å¯¦çœŸç¼½æœ‹èƒ½ã€‚å¥¢æ€›ä¿±é“æ€¯éƒ½è«³æ€–æ¢µå°¼æ€¯ä¸€ç½°å¿ƒç¼½è¬¹ç¼½è–©è‹¦å¥¢å¤¢æ€¯å¸æ¢µé æœ‹é™€è«³é™€ç©†è«³æ‰€å‘çŸ¥æ¶…ä¾„ä»¥è–©æ€¯æƒ³å¤·å¥¢é†¯æ•¸ç¾…æ€¯è«¸

åœ¨[è¿™é‡Œ](http://www.keyfc.net/bbs/tools/tudoucode.aspx)è§£å¯†, å¾—åˆ° flag.

`flag{w0_fo_ci_Be1}`

~~æ‰€ä»¥é‚£å¼ å›¾çœŸçš„æ²¡æœ‰ç”¨å•Š....~~

### ç§˜å¯†æ–‡ä»¶

æ‰“å¼€æµé‡åŒ…, å‘ç°å¤§é‡ FTP åè®®æµé‡, è·Ÿè¸ª.

![image-20210130153937974](2021-Weekly-Misc/image-20210130153937974.png)

å‘ç°ä¸€ä¸ª rar æ–‡ä»¶, binwalk åˆ†ç¦», å‘ç°æœ‰å¯†ç , çˆ†ç ´, å¾—å£ä»¤ä¸º`1903`, è§£å‹å¾— flag.

`flag{d72e5a671aa50fa5f400e5d10eedeaa5}`

~~æˆ‘ä¸€å¼€å§‹è¿˜ä»¥ä¸ºå¯†ç æ˜¯ctfæ¥ç€...~~



### [BJDCTF2020] ä½ çŒœæˆ‘æ˜¯ä¸ªå•¥

ä¸‹è½½é™„ä»¶, æ‰“å¼€, æç¤ºä¸æ˜¯ä¸ªæœ‰æ•ˆçš„å‹ç¼©æ–‡ä»¶...

010 Editor, å‘ç°æ˜¯ä¸ª png, æ‰“å¼€å‘ç°æ˜¯ä¸€ä¸ªäºŒç»´ç , åœ¨æ–‡ä»¶å°¾æœ‰æ˜æ–‡ flag.

`flag{i_am_fl@g}`



### [BJDCTF 2nd] EasyBaBa

ä¸‹è½½, å¾—åˆ°ä¸€ä¸ª 19.9 MB çš„ 454x427 çš„ jpg æ–‡ä»¶...è¿™å¤§å°æ˜¾ç„¶ä¸å¯¹å•Š...

binwalk åˆ†ç¦», å‘ç° zip ç»“å°¾, ä» `0x6E43`æ‰‹åŠ¨åˆ†ç¦» zip, å¾—åˆ°äº†è¿™ä¸ª

![image-20210130223536091](2021-Weekly-Misc/image-20210130223536091.png)

æŸ¥çœ‹æ–‡ä»¶å¤´, å‘ç°æ˜¯ä¸€ä¸ª avi è§†é¢‘, æ‰“å¼€, åœ¨é‡Œé¢å‘ç°å‡ ä¸ªéšè—çš„ä¸€é—ªè€Œè¿‡çš„äºŒç»´ç , æˆªå›¾, ç”¨ QR Research è§£ç , æ‹¼æ¥å¾—flag.

`flag{imagin_love_Y1ng}`



## Week 5, 01/31 - 02/06, BUUCTF

### [SWPU2019] ç¥å¥‡çš„äºŒç»´ç 

ä¸‹è½½é™„ä»¶, æ‰“å¼€, ç”¨ binwalk åˆ†ç¦»ä¸€ä¸‹, å¾—åˆ°å››ä¸ª rar å‹ç¼©åŒ….

![image-20210131162556648](2021-Weekly-Misc/image-20210131162556648.png)

å…ˆçœ‹ç¬¬ä¸€ä¸ª`7104.rar`, é‡Œé¢æœ‰ä¸€ä¸ª `encode.txt`, æ‰“å¼€æ˜¯ä¸€æ®µ base64: `YXNkZmdoamtsMTIzNDU2Nzg5MA==`, è§£ç å¾—`asdfghjkl1234567890`.

å¯¹äº`716A.rar`, æœ‰ä¸€å¼ å›¾ç‰‡å’Œå‹ç¼©åŒ…, å†…å±‚å‹ç¼©åŒ…éœ€è¦å¯†ç  - ä¹Ÿå°±æ˜¯æˆ‘ä»¬åˆšåˆšæ‹¿åˆ°çš„è§£ç åçš„å†…å®¹...ä¸è¿‡è§£å‹ä¹‹åæ£€æŸ¥, å¹¶æ²¡å‘ç° flag...

~~çœ‹çœ‹flagåœ¨ä¸åœ¨é‡Œé¢?~~

~~ä¸åœ¨ğŸ˜¡~~

åœ¨`17012.rar`ä¸­, æˆ‘ä»¬å‘ç°äº†ä¸€ä¸ª flag.doc, é‡Œé¢æœ‰ä¸€æ®µå¾ˆé•¿çš„, çœ‹ä¸Šå»æ˜¯ base64 çš„ä¸œè¥¿, è§£ç ä¸€ä¸‹, å˜æˆäº†å¦ä¸€æ®µ base64... ~~æœ‰ç‚¹æ„æ€~~

é‡å¤è§£ç å¤šæ¬¡ä¹‹å, æˆ‘ä»¬å¾—åˆ°äº†`comEON_YOuAreSOSoS0great`, ç”¨è¿™ä¸ªè§£å‹ `18394.rar`, æœ‰ä¸€æ®µéŸ³é¢‘.

æ”¾åˆ° Audacity é‡Œçœ‹ä¸€ä¸‹, æ˜æ˜¾æ˜¯[æ‘©å°”æ–¯ç”µç ](https://zh.wikipedia.org/wiki/æ‘©å°”æ–¯ç”µç ), ç”¨[è¿™ä¸ª](https://morsecode.world/international/decoder/audio-decoder-adaptive.html)è§£ç ä¸€ä¸‹(æˆ–è€…è‡ªå·±æ¥ä¹Ÿè¡Œ), å¾—åˆ° flag.

![image-20210131164320704](2021-Weekly-Misc/image-20210131164320704.png)

flag: `flag{morseisveryveryeasy}`



BTW, ç›´æ¥æ‰«æäºŒç»´ç ä¼šå‘Šè¯‰ä½  `flag is not here`...

![image-20210131164506602](2021-Weekly-Misc/image-20210131164506602.png)

### [BJDCTF2020] ä¸€å¶éšœç›®

ä¸‹è½½æ‰“å¼€, å‘ç° Honeyview æ‰“ä¸å¼€å›¾ç‰‡, ä½†æ˜¯èµ„æºç®¡ç†å™¨èƒ½æ˜¾ç¤ºé¢„è§ˆå›¾ - æ˜¾ç„¶å›¾çš„æŸäº›ä¸œè¥¿æ˜¯è¢«æ”¹è¿‡äº†.

ç”¨ 010 Editor æ‰“å¼€, æŠ¥äº† CRC æ ¡éªŒé”™è¯¯, ç»“åˆä¹‹å‰çœ‹åˆ°çš„æ¡çŠ¶å›¾æ¡ˆ, æ€€ç–‘æ˜¯å®½é«˜è¢«æ”¹äº†.

å¯¹äº [PNG å›¾ç‰‡](https://dev.gameres.com/Program/Visual/Other/PNGFormat.htm), å®½é«˜è¿™äº›ä¿¡æ¯ä¿å­˜åœ¨ IHDR ä¸­, ä½œä¸ºç¬¬ä¸€ä¸ªæ•°æ®å—ç´§æ¥ç€æ–‡ä»¶å¤´ä¹‹å. IHDR é•¿ 13 å­—èŠ‚, å®šä¹‰å¦‚ä¸‹.

![image-20210201205712447](2021-Weekly-Misc/image-20210201205712447.png)

æ‰€ä»¥åœ¨å·²çŸ¥ CRC çš„å‰æä¸‹, æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨åˆç†èŒƒå›´å†…ç©·ä¸¾å®½é«˜çš„æ–¹å¼å¾—åˆ°æ­£ç¡®çš„å¤§å°.

```python
#coding=utf-8
import zlib
import struct
import time

time_start=time.time()

#è¯»æ–‡ä»¶
file = '1.png'  #æ³¨æ„ï¼Œ1.pngå›¾ç‰‡è¦å’Œè„šæœ¬åœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹å“¦~
fileRead = open(file,'rb').read()
data = bytearray(fileRead[12:29]) #0xCh ~ 0x1Ch
crc32key = eval(str(fileRead[29:33]).replace('\\x','').replace("b'",'0x').replace("'",''))

#crc32key = 0xCBD6DF8A #è¡¥ä¸Š0xï¼Œcopy hex value
#data = bytearray(b'\x49\x48\x44\x52\x00\x00\x01\xF4\x00\x00\x01\xF1\x08\x06\x00\x00\x00')  #hexä¸‹copy grep hex
n = 4095 #ç†è®ºä¸Š0xffffffff,ä½†è€ƒè™‘åˆ°å±å¹•å®é™…ï¼Œ0x0fffå°±å·®ä¸å¤šäº†

for w in range(n):#é«˜å’Œå®½ä¸€èµ·çˆ†ç ´
    width = bytearray(struct.pack('>i', w))#qä¸º8å­—èŠ‚ï¼Œiä¸º4å­—èŠ‚ï¼Œhä¸º2å­—èŠ‚
    for h in range(n):
        height = bytearray(struct.pack('>i', h))
        for x in range(4):
            data[x+4] = width[x]
            data[x+8] = height[x]
            #print(data)
        crc32result = zlib.crc32(data)
        if crc32result == crc32key:
            #print("Correct Width: " + (width) + "\nCorrect Height: " + (height))
            #å†™æ–‡ä»¶
            newpic = bytearray(fileRead)
            for x in range(4):
                newpic[x+16] = width[x]
                newpic[x+20] = height[x]
            fw = open(file+'_CRC_Repaired.png','wb')#ä¿å­˜å‰¯æœ¬
            fw.write(newpic)
            fw.close

time_end=time.time()
print("CRC Repaired, saved as " + file+'_CRC_Repaired.png')
print('Time Used: ',str(time_end-time_start),'s')

```

æŸ¥çœ‹ä¿®å¤åçš„å›¾ç‰‡, å¾—åˆ° flag.

`flag{66666}`

